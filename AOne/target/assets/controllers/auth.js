"use strict";app.controller("AuthController",function(e,t,n,r,i,s,o){t.login=function(e){o.login.get({email:e.email,pw:e.password},function(o){if(o.USER_ID!=null){e.uid=o.USER_ID;e.name=o.USER_NAME;e.gravatar=o.USER_GRAVATAR;e.email=o.USER_EMAIL;e.signedIn=true;s.setCurrentUser(e);if(s.isSignedIn){var u=s.getCurrentUser();n.$broadcast("userEvent",e);i.pop("success","Logged in!");r.path(baseUrl+"browse")}else{i.pop("error","Login failed!");t.user=""}}else{i.pop("error","Login failed! Check Credentials")}})};t.register=function(e){var o={username:e.name,email:e.email,pw:e.password};s.registerUser(o).then(function(e){if(e.data){e.uid=e.data.USER_ID;e.name=e.data.USER_NAME;e.gravatar=e.data.USER_GRAVATAR;e.email=e.data.USER_EMAIL;e.signedIn=true;s.setCurrentUser(e);if(s.isSignedIn){var o=s.getCurrentUser();n.$broadcast("userEvent",e);i.pop("success","Registered!");r.path(baseUrl+"browse")}else{i.pop("error","Signup failed!");t.user=""}}})};t.changePassword=function(e){var n={oldpw:e.oldPass,newpw:e.newPass,email:e.email};s.changePassword(n).success(function(e){if(e==401){i.pop("failed","Password change failed! Retry")}else{i.pop("success","Password changed!");t.user=""}})}})